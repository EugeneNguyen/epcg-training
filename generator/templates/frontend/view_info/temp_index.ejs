import {useMutation, useQuery} from "@apollo/client";
import {useParams, useHistory} from "react-router-dom";
import {useState} from "react";
import {toast} from 'react-toastify';
import {Row, Col} from 'reactstrap';
import API from '../apis';
import {AlertError} from '../../../components/alert';
import {Form, Input} from '../../../components/form';

export default function View<%= modelNameCapitalCamel %>Info() {
  const { id: objectId } = useParams();
  const history = useHistory();

<% for (const field of fieldsArray) { -%>
  const [<%= field.name %>, set<%= field.name %>] = useState(null);
<% } -%>

  const { loading, error, data, refetch } = useQuery(
    API.GET_BY_ID,
    {
      ...API.DEFAULT_OPTIONS,
      variables: { id: objectId },
      onCompleted: (response) => {
<% for (const field of fieldsArray) { -%>
        set<%= field.name %>(response.<%= modelNameSnake %>_get_by_id.<%= field.name %>);
<% } -%>
      },
    }
  );

  if (loading) return "Loading ...";
  if (error) return "Error";
  if (!data) return "No data";

  return (
    <Row>
      <Col sm={6}>
        <Form>
<% for (const field of fieldsArray) { -%>
          <Input
            type="text"
            name="<%= field.name %>"
            displayLabel="<%= field.displayLabel %>"
            value={<%= field.name %>}
            disabled
          />
<% } -%>
        </Form>
      </Col>
    </Row>
  );
}
